<!doctype html>
<html lang="en">
  <head>
    <title>Node Contribution Support | EdgeNet Project</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="css/frame.css" media="screen" rel="stylesheet" type="text/css" />
    <link href="css/controls.css" media="screen" rel="stylesheet" type="text/css" />
    <link href="css/custom.css" media="screen" rel="stylesheet" type="text/css" />
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Open+Sans+Condensed:300,700' rel='stylesheet' type='text/css'>
    <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,700" rel="stylesheet">
    <link rel="apple-touch-icon" sizes="57x57" href="img/favicon/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="img/favicon/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="img/favicon/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="img/favicon/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="img/favicon/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="img/favicon/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="img/favicon/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="img/favicon/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="img/favicon/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192"  href="img/favicon/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="img/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="img/favicon/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="img/favicon/favicon-16x16.png">
    <link rel="manifest" href="img/favicon/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="favicon/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="js/menu.js"></script>
    <style>
      .menu-support {
        color: rgb(96, 134, 214) !important;
        opacity: 1 !important;
        font-weight: 700 !important;
      }
    </style>
  </head>
  <body>
    <div class="menu-container"></div>
    <div class="content-container">
      <div class="content">
        <div class="content-table flex-column">
          <!-- ************************************************************************************** -->
          <div class="flex-row">
            <div class="flex-item flex-item-stretch flex-column">
              <h1 id="contributing-a-node-into-the-edgenet-cluster">Contributing a Node into the EdgeNet cluster</h1>
              <p>This tutorial describes how a node can join EdgeNet. An authority administrator manages, perhaps by delegating the responsibilities, the nodes contributed by the authority itself or maybe authority users.</p>
              <p>Besides the nodes provided by EdgeNet partners, each authority in EdgeNet can become a contributor to enlarge the cluster. An authority is able to allow their contributions to be <em>schedulable<em> or <em>unschedulable<em> for deployments.</p>
              <p>As a contributor to the infrastructure, you will set up a VM and make it available to EdgeNet. Step by step, you will enable SSH server, create a new SSH user as a sudoer, and put our SSH public key into authorized keys or set a password that is not recommended. EdgeNet automates the installation and recovery processes of nodes.</p>
              <p>The more you and other authorities contribute, the more of the global infrastructure all EdgeNet users can use. You can disable or remove the nodes that you contribute if and when you desire.</p>
              <h3 id="a-note-on-the-operating-systems-we-currently-support">A note on the operating systems we currently support</h3>
              <p>We strongly recommend that you choose <em>Ubuntu</em> or <em>CentOS</em> as the operating system on the server you want to add to the EdgeNet cluster. We tend to increase the supported operating systems.</p>
              <h2 id="technologies-you-will-use">Technologies you will use</h2>
              <p>You will use <a href="https://kubernetes.io/docs/reference/kubectl/overview/"><code>kubectl</code></a>, the <a href="https://kubernetes.io/">Kubernetes</a> command-line interface.</p>
              <h2 id="what-you-will-do">What you will do</h2>
              <p>In the first place, please be sure your site, if exists, doesn't block the <a href="https://kubernetes.io/docs/setup/production-environment/tools/kubeadm/install-kubeadm/#check-required-ports">required ports</a>. You will enable SSH server on your server, then create an EdgeNet user as a <b>sudoer</b>, and copy &amp; paste the contents of our <a href="https://github.com/EdgeNet-project/headnode/blob/release-1.0/config/id_rsa.pub">SSH public key</a> into authorized keys. Once you have done so, you will use the user-specific kubeconfig file provided by EdgeNet to create a <em>node contribution</em> object. Object creation generates an SSH client allowing the headnode to connect to your server running an SSH server. You don't need to do anything since the node contribution controller starts a pre-defined procedure including the installation of necessary packages and running the kubeadm join command.</p>
              <h2 id="steps">Steps</h2>
              <h3 id="make-sure-you-have-the-kubernetes-command-line-tool">Make sure you have the Kubernetes command-line tool</h3>
              <p>If you do not already have <code>kubectl</code>, you will need to install it on your system. Follow the <a href="https://kubernetes.io/docs/tasks/tools/install-kubectl/">Kubernetes documentation</a> for this.</p>
              <h3 id="save-your-access-credential">Save your access credential</h3>
              <p>The user-specific kubeconfig file provided by EdgeNet when you registered in allows you to do node contributions. In what follows, we will assume that it is saved in your working directory on your system as <code>./edgenet-kubeconfig.cfg</code>.</p>
              <h3 id="prepare-a-description-of-your-node-contribution">Prepare a description of your node contribution</h3>
              <p>The <a href="https://kubernetes.io/docs/concepts/overview/working-with-objects/kubernetes-objects/"><code>.yaml</code> format</a> is used to describe Kubernetes objects. Create one for the node contribution object, following the model of the example shown below. Your <code>.yaml</code>file must specify the following information regarding your future node contribution:</p>
              <ul>
              <li>the <strong>node name</strong> that will be used by the EdgeNet system; it must follow <a href="https://kubernetes.io/docs/concepts/overview/working-with-objects/names/">Kubernetes&#39; rules for names</a> and must be different from any existing node names in your authority</li>
              <li>the <strong>namespace</strong> of the authority</li>
              <li>the <strong>host</strong> of the node contribution, which is a human-readable IP address in IPv4 or IPv6 format</li>
              <li>the <strong>port</strong> of the SSH server, which is 22 by default and recommended to allocate another port such as port 25020</li>
              <li>the <strong>enabled</strong> of the scheduling; which is a boolean, and this should be true if you want to open the node you contribute</li>
              <li>the <strong>user</strong> of the SSH client, which is the user you created on your server as a sudoer</li>
              <li>the <strong>password</strong> of the SSH user; you don't need to define that if you put our public SSH key exists in authorized keys</li>
              </ul>
              <p>In what follows, we will assume that this file is saved in your working directory on your system as <code>./nodecontribution.yaml</code>.</p>
              <p>Example:</p>
              <pre class="pre"><code class="lang-yaml">apiVersion: apps.edgenet.io/v1alpha
kind: NodeContribution
metadata:
  name: ple-1
  namespace: authority-lip6-lab
spec:
  host: 132.227.123.46
  port: 25010
  enabled: true
  user: edgenet</code></pre>
              <h3 id="do-your-node-contribution">Do your node contribution</h3>
              <p>Using <code>kubectl</code>, create a node contribution object:</p>
              <pre class="pre"><code>kubectl create -f ./nodecontribution.yaml --kubeconfig ./edgenet-kubeconfig.cfg</code></pre>
              <p>This will start a procedure including the automated installation processes.</p>
              <h3 id="check-the-installation-status-of-the-node-contribution">Check the installation status of the node contribution</h3>
              <p>At this point, EdgeNet lists status messages to inform you about installation steps. You can have status details by invoking the kubectl describe command with a node name and your authority namespace that defined as <strong>ple-1</strong> and <strong>authority-lip6-lab</strong> in this tutorial.</p>
              <p>Using <code>kubectl</code>, get status details of a node contribution object:</p>
              <pre class="pre"><code>kubectl describe nodecontribution ple-1 -n authority-lip6-lab --kubeconfig ./edgenet-kubeconfig.cfg</code></pre>
            </div>
          </div>
          <!-- ************************************************************************************** -->
        </div>
      </div>
    </div>
    <!--Start of Tawk.to Script-->
    <script type="text/javascript">
      var Tawk_API=Tawk_API||{}, Tawk_LoadStart=new Date();
      (function(){
      var s1=document.createElement("script"),s0=document.getElementsByTagName("script")[0];
      s1.async=true;
      s1.src='https://embed.tawk.to/5e998adf35bcbb0c9ab2157d/default';
      s1.charset='UTF-8';
      s1.setAttribute('crossorigin','*');
      s0.parentNode.insertBefore(s1,s0);
      })();
    </script>
    <!--End of Tawk.to Script-->
  </body>
</html>
